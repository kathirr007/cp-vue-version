!function(o,l){"use strict";function e(e,t,n){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(t===l)throw"invalid module definition, dependencies must be specified";if(n===l)throw"invalid module definition, definition function must be specified";!function(e,t){for(var n,i=[],r=0;r<e.length;++r){if(!(n=c[e[r]]||a(e[r])))throw"module definition dependecy not found: "+e[r];i.push(n)}t.apply(null,i)}(t,function(){c[e]=n.apply(null,arguments)})}function a(e){for(var t=o,n=e.split(/[.\/]/),i=0;i<n.length;++i){if(!t[n[i]])return;t=t[n[i]]}return t}var c={};e("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(i,l,c){function u(t,e){return i.each(e,function(e){t=e.constructor==RegExp?t.replace(e,""):t.replace(e[0],e[1])}),t}return{filter:u,innerText:function(e){var t=new c,n=new l({},t),r="",a=t.getShortEndedElements(),s=i.makeMap("script noscript style textarea video audio iframe object"," "),o=t.getBlockElements();return e=u(e,[/<!\[[^\]]+\]>/g]),function e(t){var n=t.name,i=t;if("br"!==n)if(a[n]&&(r+=" "),s[n])r+=" ";else{if(3==t.type&&(r+=t.value),!t.shortEnded&&(t=t.firstChild))for(;e(t),t=t.next;);o[n]&&i.next&&(r+="\n","p"==n&&(r+="\n"))}else r+="\n"}(n.parse(e)),r},trimHtml:function(e){return u(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(e,t,n){return t||n?" ":" "}],/<br>$/i])}}}),e("tinymce/pasteplugin/Clipboard",["tinymce/Env","tinymce/dom/RangeUtils","tinymce/util/VK","tinymce/pasteplugin/Utils"],function(x,_,t,P){return function(l){function c(e){var t,n=l.dom;if(t=l.fire("BeforePastePreProcess",{content:e}),e=(t=l.fire("PastePreProcess",t)).content,!t.isDefaultPrevented()){if(l.hasEventListeners("PastePostProcess")&&!t.isDefaultPrevented()){var i=n.add(l.getBody(),"div",{style:"display:none"},e);t=l.fire("PastePostProcess",{node:i}),n.remove(i),e=t.node.innerHTML}t.isDefaultPrevented()||l.insertContent(e,{merge:!1!==l.settings.paste_merge_formats,data:{paste:!0}})}}function s(e){e=l.dom.encode(e).replace(/\r\n/g,"\n");var t,n=l.dom.getParent(l.selection.getStart(),l.dom.isBlock),i=l.settings.forced_root_block;i&&(t=(t=l.dom.createHTML(i,l.settings.forced_root_block_attrs)).substr(0,t.length-3)+">"),n&&/^(PRE|DIV)$/.test(n.nodeName)||!i?e=P.filter(e,[[/\n/g,"<br>"]]):-1!=(e=P.filter(e,[[/\n\n/g,"</p>"+t],[/^(.*<\/p>)(<p>)$/,t+"$1"],[/\n/g,"<br />"]])).indexOf("<p>")&&(e=t+e),c(e)}function o(){var e,a=l.dom,t=l.getBody(),n=l.dom.getViewPort(l.getWin()).y,i=20;if(v=l.selection.getRng(),l.inline&&((e=l.selection.getScrollContainer())&&0<e.scrollTop&&(n=e.scrollTop)),v.getClientRects){var r=function(e){var t,n,i,r=e.startContainer;if((t=e.getClientRects()).length)return t[0];if(e.collapsed&&1==r.nodeType){for(i=r.childNodes[v.startOffset];i&&3==i.nodeType&&!i.data.length;)i=i.nextSibling;if(i)return"BR"==i.tagName&&(n=a.doc.createTextNode("\ufeff"),i.parentNode.insertBefore(n,i),(e=a.createRng()).setStartBefore(n),e.setEndAfter(n),t=e.getClientRects(),a.remove(n)),t.length?t[0]:void 0}}(v);if(r)i=n+(r.top-a.getPos(t).y);else{i=n;var s=v.startContainer;s&&(3==s.nodeType&&s.parentNode!=t&&(s=s.parentNode),1==s.nodeType&&(i=a.getPos(s,e||t).y))}}g=a.add(l.getBody(),"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: absolute; top: "+i+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},w),(x.ie||x.gecko)&&a.setStyle(g,"left","rtl"==a.getStyle(t,"direction",!0)?65535:-65535),a.bind(g,"beforedeactivate focusin focusout",function(e){e.stopPropagation()}),g.focus(),l.selection.select(g,!0)}function u(){if(g){for(var e;e=l.dom.get("mcepastebin");)l.dom.remove(e),l.dom.unbind(e);v&&l.selection.setRng(v)}g=v=null}function d(){var e,t,n,i,r="";for(e=l.dom.select("div[id=mcepastebin]"),t=0;t<e.length;t++)(n=e[t]).firstChild&&"mcepastebin"==n.firstChild.id&&(n=n.firstChild),i=n.innerHTML,r!=w&&(r+=i);return r}function f(e){var t={};if(e){if(e.getData){var n=e.getData("Text");n&&0<n.length&&-1==n.indexOf(a)&&(t["text/plain"]=n)}if(e.types)for(var i=0;i<e.types.length;i++){var r=e.types[i];t[r]=e.getData(r)}}return t}function p(s,o){function e(e){function t(e){o&&(l.selection.setRng(o),o=null),c('<img src="'+e.result+'">')}var n,i,r,a=!1;if(e)for(n=0;n<e.length;n++)i=e[n],/^image\/(jpeg|png|gif|bmp)$/.test(i.type)&&((r=new FileReader).onload=t.bind(null,r),r.readAsDataURL(i.getAsFile?i.getAsFile():i),s.preventDefault(),a=!0);return a}var t=s.clipboardData||s.dataTransfer;return l.settings.paste_data_images&&t?e(t.items)||e(t.files):void 0}function m(e,t){return t in e&&0<e[t].length}function n(e){return t.metaKeyPressed(e)&&86==e.keyCode||e.shiftKey&&45==e.keyCode}function e(){l.on("keydown",function(e){function t(e){n(e)&&!e.isDefaultPrevented()&&u()}if(n(e)&&!e.isDefaultPrevented()){if((h=e.shiftKey&&86==e.keyCode)&&x.webkit&&-1!=navigator.userAgent.indexOf("Version/"))return;if(e.stopImmediatePropagation(),b=(new Date).getTime(),x.ie&&h)return e.preventDefault(),void l.fire("paste",{ieFake:!0});u(),o(),l.once("keyup",t),l.once("paste",function(){l.off("keyup",t)})}}),l.on("paste",function(e){var t=(new Date).getTime(),n=function(e){return f(e.clipboardData||l.getDoc().dataTransfer)}(e),i=(new Date).getTime()-t,r=(new Date).getTime()-b-i<1e3,a="text"==y.pasteFormat||h;return h=!1,e.isDefaultPrevented()||function(e){var t=e.clipboardData;return-1!=navigator.userAgent.indexOf("Android")&&t&&t.items&&0===t.items.length}(e)?void u():p(e)?void u():(r||e.preventDefault(),!x.ie||r&&!e.ieFake||(o(),l.dom.bind(g,"paste",function(e){e.stopPropagation()}),l.getDoc().execCommand("Paste",!1,null),n["text/html"]=d()),void setTimeout(function(){var e;return m(n,"text/html")?e=n["text/html"]:(e=d())==w&&(a=!0),e=P.trimHtml(e),g&&g.firstChild&&"mcepastebin"===g.firstChild.id&&(a=!0),u(),e.length||(a=!0),a&&(e=m(n,"text/plain")&&-1==e.indexOf("</p>")?n["text/plain"]:P.innerText(e)),e==w?void(r||l.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")):void(a?s(e):c(e))},0))}),l.on("dragstart dragend",function(e){r="dragstart"==e.type}),l.on("drop",function(e){var t=function(e){return _.getCaretRangeFromPoint(e.clientX,e.clientY,l.getDoc())}(e);if(!e.isDefaultPrevented()&&!r&&!p(e,t)&&t&&!1!==l.settings.paste_filter_drop){var n=f(e.dataTransfer),i=n["mce-internal"]||n["text/html"]||n["text/plain"];i&&(e.preventDefault(),l.undoManager.transact(function(){n["mce-internal"]&&l.execCommand("Delete"),l.selection.setRng(t),i=P.trimHtml(i),n["text/html"]?c(i):s(i)}))}}),l.on("dragover dragend",function(e){l.settings.paste_data_images&&e.preventDefault()})}var g,v,h,y=this,b=0,r=!1,w="%MCEPASTEBIN%",a="data:text/mce-internal,";y.pasteHtml=c,y.pasteText=s,l.on("preInit",function(){e(),l.parser.addNodeFilter("img",function(e,t,n){function i(e){e.attr("data-mce-object")||a===x.transparentSrc||e.remove()}if(!l.settings.paste_data_images&&((s=n).data&&!0===s.data.paste))for(var r=e.length;r--;){var a=e[r].attributes.map.src;a&&(0===a.indexOf("webkit-fake-url")?i(e[r]):l.settings.allow_html_data_urls||0!==a.indexOf("data:")||i(e[r]))}var s})})}}),e("tinymce/pasteplugin/WordFilter",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema","tinymce/html/Serializer","tinymce/html/Node","tinymce/pasteplugin/Utils"],function(d,f,p,m,g,v){function h(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)}function y(t){var n,e;return e=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],t=t.replace(/^[\u00a0 ]+/,""),d.each(e,function(e){return e.test(t)?!(n=!0):void 0}),n}function e(c){var u=c.settings;c.on("BeforePastePreProcess",function(e){function i(n,i){var r,a={},e=c.dom.parseStyle(i);return d.each(e,function(e,t){switch(t){case"mso-list":(r=/\w+ \w+([0-9]+)/i.exec(i))&&(n._listLevel=parseInt(r[1],10)),/Ignore/i.test(e)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":t="text-align";break;case"vert-align":t="vertical-align";break;case"font-color":case"mso-foreground":t="color";break;case"mso-background":case"mso-highlight":t="background";break;case"font-weight":case"font-style":return void("normal"!=e&&(a[t]=e));case"mso-element":if(/^(comment|comment-list)$/i.test(e))return void n.remove()}return 0===t.indexOf("mso-comment")?void n.remove():void(0!==t.indexOf("mso-")&&("all"==s||o&&o[t])&&(a[t]=e))}),/(bold)/i.test(a["font-weight"])&&(delete a["font-weight"],n.wrap(new g("b",1))),/(italic)/i.test(a["font-style"])&&(delete a["font-style"],n.wrap(new g("i",1))),(a=c.dom.serializeStyle(a,n.name))||null}var s,o,t=e.content;if(t=(t=t.replace(/<b[^>]+id="?docs-internal-[^>]*>/gi,"")).replace(/<br class="?Apple-interchange-newline"?>/gi,""),(s=u.paste_retain_style_properties)&&(o=d.makeMap(s.split(/[, ]/))),!1!==u.paste_enable_default_filters&&h(e.content)){e.wordContent=!0,t=v.filter(t,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return 0<t.length?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""}]]);var n=u.paste_word_valid_elements;n||(n="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody");var r=new p({valid_elements:n,valid_children:"-li[p]"});d.each(r.elements,function(e){e.attributes.class||(e.attributes.class={},e.attributesOrder.push("class")),e.attributes.style||(e.attributes.style={},e.attributesOrder.push("style"))});var a=new f({},r);a.addAttributeFilter("style",function(e){for(var t,n=e.length;n--;)(t=e[n]).attr("style",i(t,t.attr("style"))),"span"==t.name&&t.parent&&!t.attributes.length&&t.unwrap()}),a.addAttributeFilter("class",function(e){for(var t,n,i=e.length;i--;)n=(t=e[i]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&t.remove(),t.attr("class",null)}),a.addNodeFilter("del",function(e){for(var t=e.length;t--;)e[t].remove()}),a.addNodeFilter("a",function(e){for(var t,n,i,r=e.length;r--;)if(n=(t=e[r]).attr("href"),i=t.attr("name"),n&&-1!=n.indexOf("#_msocom_"))t.remove();else if(n&&0===n.indexOf("file://")&&((n=n.split("#")[1])&&(n="#"+n)),n||i){if(i&&!/^_?(?:toc|edn|ftn)/i.test(i)){t.unwrap();continue}t.attr({href:n,name:i})}else t.unwrap()});var l=a.parse(t);!1!==u.paste_convert_word_fake_lists&&function(e){function n(e){var t="";if(3===e.type)return e.value;if(e=e.firstChild)for(;t+=n(e),e=e.next;);return t}function r(e,t){if(3===e.type&&t.test(e.value))return e.value=e.value.replace(t,""),!1;if(e=e.firstChild)do{if(!r(e,t))return!1}while(e=e.next);return!0}function t(e,t,n){var i=e._listLevel||o;i!=o&&(i<o?a&&(a=a.parent.parent):(s=a,a=null)),a&&a.name==t?a.append(e):(s=s||a,a=new g(t,1),1<n&&a.attr("start",""+n),e.wrap(a)),e.name="li",o<i&&s&&s.lastChild.append(a),o=i,function e(t){if(t._listIgnore)t.remove();else if(t=t.firstChild)for(;e(t),t=t.next;);}(e),r(e,/^\u00a0+/),r(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),r(e,/^\u00a0+/)}for(var a,s,o=1,i=[],l=e.firstChild;null!=l;)if(i.push(l),null!==(l=l.walk()))for(;void 0!==l&&l.parent!==e;)l=l.walk();for(var c=0;c<i.length;c++)if("p"==(e=i[c]).name&&e.firstChild){var u=n(e);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(u)){t(e,"ul");continue}if(y(u)){var d=/([0-9]+)\./.exec(u),f=1;d&&(f=parseInt(d[1],10)),t(e,"ol",f);continue}if(e._listLevel){t(e,"ul",1);continue}a=null}else s=a,a=null}(l),e.content=new m({},r).serialize(l)}})}return e.isWordContent=h,e}),e("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(t,r,a,s){return function(i){function e(t){i.on("BeforePastePreProcess",function(e){e.content=t(e.content)})}t.webkit&&e(function(e){if(a.isWordContent(e))return e;var c=i.settings.paste_webkit_styles;if(!1===i.settings.paste_remove_styles_if_webkit||"all"==c)return e;if(c&&(c=c.split(/[, ]/)),c){var u=i.dom,d=i.selection.getNode();e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(e,t,n,i){var r=u.parseStyle(n,"span"),a={};if("none"===c)return t+i;for(var s=0;s<c.length;s++){var o=r[c[s]],l=u.getStyle(d,c[s],!0);/color/.test(c[s])&&(o=u.toHex(o),l=u.toHex(l)),l!=o&&(a[c[s]]=o)}return(a=u.serializeStyle(a,"span"))?t+' style="'+a+'"'+i:t+i})}else e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return e.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(e,t,n,i){return t+' style="'+n+'"'+i})}),t.ie&&e(function(e){if(!a.isWordContent(e))return e;var n=[];r.each(i.schema.getBlockElements(),function(e,t){n.push(t)});var t=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return e=s.filter(e,[[t,"$1"]]),s.filter(e,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])})}}),e("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(e,a,s,o){var l;e.add("paste",function(e){function t(){"text"==n.pasteFormat?(this.active(!1),n.pasteFormat="html"):(n.pasteFormat="text",this.active(!0),l||(e.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),l=!0))}var n,i=this,r=e.settings;i.clipboard=n=new a(e),i.quirks=new o(e),i.wordFilter=new s(e),e.settings.paste_as_text&&(i.clipboard.pasteFormat="text"),r.paste_preprocess&&e.on("PastePreProcess",function(e){r.paste_preprocess.call(i,i,e)}),r.paste_postprocess&&e.on("PastePostProcess",function(e){r.paste_postprocess.call(i,i,e)}),e.addCommand("mceInsertClipboardContent",function(e,t){t.content&&i.clipboard.pasteHtml(t.content),t.text&&i.clipboard.pasteText(t.text)}),e.paste_block_drop&&e.on("dragend dragover draggesture dragdrop drop drag",function(e){e.preventDefault(),e.stopPropagation()}),e.settings.paste_data_images||e.on("drop",function(e){var t=e.dataTransfer;t&&t.files&&0<t.files.length&&e.preventDefault()}),e.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:t,active:"text"==i.clipboard.pasteFormat}),e.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:n.pasteFormat,onclick:t})})}),function(e){var t,n,i,r,a;for(t=0;t<e.length;t++){n=o,r=(i=e[t]).split(/[.\/]/);for(var s=0;s<r.length-1;++s)n[r[s]]===l&&(n[r[s]]={}),n=n[r[s]];n[r[r.length-1]]=c[i]}if(o.AMDLC_TESTS){for(i in a=o.privateModules||{},c)a[i]=c[i];for(t=0;t<e.length;t++)delete a[e[t]];o.privateModules=a}}(["tinymce/pasteplugin/Utils"])}(this);