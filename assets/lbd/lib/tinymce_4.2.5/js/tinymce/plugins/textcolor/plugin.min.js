tinymce.PluginManager.add("textcolor",function(u){function t(){function t(t,e){var o="transparent"==t;return'<td class="mce-grid-cell'+(o?" mce-colorbtn-trans":"")+'"><div id="'+i+"-"+s+++'" data-mce-color="'+(t||"")+'" role="option" tabIndex="-1" style="'+(t?"background-color: "+t:"")+'" title="'+tinymce.translate(e)+'">'+(o?"&#215;":"")+"</div></td>"}var e,o,r,a,l,n,c,i=this._id,s=0;for((e=function(){var t,e,o=[];for(e=u.settings.textcolor_map||["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"],t=0;t<e.length;t+=2)o.push({text:e[t+1],color:"#"+e[t]});return o}()).push({text:tinymce.translate("No color"),color:"transparent"}),r='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>',a=e.length-1,n=0;n<g;n++){for(r+="<tr>",l=0;l<d;l++)a<(c=n*d+l)?r+="<td></td>":r+=t((o=e[c]).color,o.text);r+="</tr>"}if(u.settings.color_picker_callback){for(r+='<tr><td colspan="'+d+'" class="mce-custom-color-btn"><div id="'+i+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+i+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+tinymce.translate("Custom...")+"</button></div></td></tr>",r+="<tr>",l=0;l<d;l++)r+=t("","Custom color");r+="</tr>"}return r+"</tbody></table>"}function o(t,e){u.undoManager.transact(function(){u.focus(),u.formatter.apply(t,{value:e}),u.nodeChanged()})}function r(t){u.undoManager.transact(function(){u.focus(),u.formatter.remove(t,{value:null},null,!0),u.nodeChanged()})}function e(t){function l(t){c.hidePanel(),c.color(t),o(c.settings.format,t)}function n(t,e){t.style.background=e,t.setAttribute("data-mce-color",e)}var e,c=this.parent();tinymce.DOM.getParent(t.target,".mce-custom-color-btn")&&(c.hidePanel(),u.settings.color_picker_callback.call(u,function(t){var e,o,r,a=c.panel.getEl().getElementsByTagName("table")[0];for(e=tinymce.map(a.rows[a.rows.length-1].childNodes,function(t){return t.firstChild}),r=0;r<e.length&&(o=e[r]).getAttribute("data-mce-color");r++);if(r==d)for(r=0;r<d-1;r++)n(e[r],e[r+1].getAttribute("data-mce-color"));n(o,t),l(t)},function(o){var r;return u.dom.getParents(u.selection.getStart(),function(t){var e;(e=t.style["forecolor"==o?"color":"background-color"])&&(r=e)}),r}(c.settings.format))),(e=t.target.getAttribute("data-mce-color"))?(this.lastId&&document.getElementById(this.lastId).setAttribute("aria-selected",!1),t.target.setAttribute("aria-selected",!0),this.lastId=t.target.id,"transparent"==e?(c.hidePanel(),c.resetColor(),r(c.settings.format)):l(e)):null!==e&&c.hidePanel()}function a(){var t=this;t._color?o(t.settings.format,t._color):r(t.settings.format)}var d,g;g=u.settings.textcolor_rows||5,d=u.settings.textcolor_cols||8,u.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:!0,html:t,onclick:e},onclick:a}),u.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:!0,html:t,onclick:e},onclick:a})});