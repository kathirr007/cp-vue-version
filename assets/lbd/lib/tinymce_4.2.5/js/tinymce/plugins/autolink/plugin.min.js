tinymce.PluginManager.add("autolink",function(t){function n(e,t,n){function i(e,t){if(t<0&&(t=0),3==e.nodeType){var n=e.data.length;n<t&&(t=n)}return t}function o(e,t){1!=e.nodeType||e.hasChildNodes()?d.setStart(e,i(e,t)):d.setStartBefore(e)}function r(e,t){1!=e.nodeType||e.hasChildNodes()?d.setEnd(e,i(e,t)):d.setEndAfter(e)}var d,f,a,s,c,l,u,h,g,C;if("A"!=e.selection.getNode().tagName){if((d=e.selection.getRng(!0).cloneRange()).startOffset<5){if(!(h=d.endContainer.previousSibling)){if(!d.endContainer.firstChild||!d.endContainer.firstChild.nextSibling)return;h=d.endContainer.firstChild.nextSibling}if(o(h,g=h.length),r(h,g),d.endOffset<5)return;f=d.endOffset,s=h}else{if(3!=(s=d.endContainer).nodeType&&s.firstChild){for(;3!=s.nodeType&&s.firstChild;)s=s.firstChild;3==s.nodeType&&(o(s,0),r(s,s.nodeValue.length))}f=1==d.endOffset?2:d.endOffset-1-t}for(a=f;o(s,2<=f?f-2:0),r(s,1<=f?f-1:0),f-=1," "!=(C=d.toString())&&""!==C&&160!=C.charCodeAt(0)&&0<=f-2&&C!=n;);d.toString()==n||160==d.toString().charCodeAt(0)?(o(s,f),r(s,a),f+=1):(0===d.startOffset?o(s,0):o(s,f),r(s,a)),"."==(l=d.toString()).charAt(l.length-1)&&r(s,a-1),(u=(l=d.toString()).match(/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i))&&("www."==u[1]?u[1]="http://www.":/@$/.test(u[1])&&!/^mailto:/.test(u[1])&&(u[1]="mailto:"+u[1]),c=e.selection.getBookmark(),e.selection.setRng(d),e.execCommand("createlink",!1,u[1]+u[2]),e.selection.moveToBookmark(c),e.nodeChanged())}}var e;return t.on("keydown",function(e){return 13==e.keyCode?function(e){n(e,-1,"")}(t):void 0}),tinymce.Env.ie?void t.on("focus",function(){if(!e){e=!0;try{t.execCommand("AutoUrlDetect",!1,!0)}catch(e){}}}):(t.on("keypress",function(e){return 41==e.keyCode?function(e){n(e,-1,"(")}(t):void 0}),void t.on("keyup",function(e){return 32==e.keyCode?function(e){n(e,0,"")}(t):void 0}))});