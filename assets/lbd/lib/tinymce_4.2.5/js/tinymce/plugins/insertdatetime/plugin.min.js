tinymce.PluginManager.add("insertdatetime",function(n){function r(e,t){function a(e,t){if((e=""+e).length<t)for(var a=0;a<t-e.length;a++)e="0"+e;return e}return t=t||new Date,(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace("%D","%m/%d/%Y")).replace("%r","%I:%M:%S %p")).replace("%Y",""+t.getFullYear())).replace("%y",""+t.getYear())).replace("%m",a(t.getMonth()+1,2))).replace("%d",a(t.getDate(),2))).replace("%H",""+a(t.getHours(),2))).replace("%M",""+a(t.getMinutes(),2))).replace("%S",""+a(t.getSeconds(),2))).replace("%I",""+((t.getHours()+11)%12+1))).replace("%p",t.getHours()<12?"AM":"PM")).replace("%B",""+n.translate(u[t.getMonth()]))).replace("%b",""+n.translate(m[t.getMonth()]))).replace("%A",""+n.translate(c[t.getDay()]))).replace("%a",""+n.translate(d[t.getDay()]))).replace("%%","%")}function t(e){var t=r(e);if(n.settings.insertdatetime_element){t='<time datetime="'+r(/%[HMSIp]/.test(e)?"%Y-%m-%dT%H:%M":"%Y-%m-%d")+'">'+t+"</time>";var a=n.dom.getParent(n.selection.getStart(),"time");if(a)return void n.dom.setOuterHTML(a,t)}n.insertContent(t)}var a,i,d="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),c="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),m="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),u="January February March April May June July August September October November December".split(" "),s=[];n.addCommand("mceInsertDate",function(){t(n.getParam("insertdatetime_dateformat",n.translate("%Y-%m-%d")))}),n.addCommand("mceInsertTime",function(){t(n.getParam("insertdatetime_timeformat",n.translate("%H:%M:%S")))}),n.addButton("insertdatetime",{type:"splitbutton",title:"Insert date/time",onclick:function(){t(a||i)},menu:s}),tinymce.each(n.settings.insertdatetime_formats||["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"],function(e){i||(i=e),s.push({text:r(e),onclick:function(){t(a=e)}})}),n.addMenuItem("insertdatetime",{icon:"date",text:"Insert date/time",menu:s,context:"insert"})});