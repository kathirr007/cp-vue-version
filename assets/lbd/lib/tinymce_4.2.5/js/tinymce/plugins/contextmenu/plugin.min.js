tinymce.PluginManager.add("contextmenu",function(a){var r,m=a.settings.contextmenu_never_use_native;a.on("contextmenu",function(e){var t,n=a.getDoc();if(!e.ctrlKey||m){if(e.preventDefault(),tinymce.Env.mac&&tinymce.Env.webkit&&2==e.button&&n.caretRangeFromPoint&&a.selection.setRng(n.caretRangeFromPoint(e.x,e.y)),t=a.settings.contextmenu||"link image inserttable | cell row column deletetable",r)r.show();else{var o=[];tinymce.each(t.split(/[ ,]/),function(e){var t=a.menuItems[e];"|"==e&&(t={text:e}),t&&(t.shortcut="",o.push(t))});for(var i=0;i<o.length;i++)"|"!=o[i].text||0!==i&&i!=o.length-1||o.splice(i,1);r=new tinymce.ui.Menu({items:o,context:"contextmenu",classes:"contextmenu"}).renderTo(),a.on("remove",function(){r.remove(),r=null})}var c={x:e.pageX,y:e.pageY};a.inline||((c=tinymce.DOM.getPos(a.getContentAreaContainer())).x+=e.clientX,c.y+=e.clientY),r.moveTo(c.x,c.y)}})});