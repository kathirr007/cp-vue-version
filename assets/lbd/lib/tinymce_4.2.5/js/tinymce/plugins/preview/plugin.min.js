tinymce.PluginManager.add("preview",function(d){var o=d.settings,s=!tinymce.Env.ie;d.addCommand("mcePreview",function(){d.windowManager.open({title:"Preview",width:parseInt(d.getParam("plugin_preview_width","650"),10),height:parseInt(d.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"'+(s?' sandbox="allow-scripts"':"")+"></iframe>",buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var e,t="";t+='<base href="'+d.documentBaseURI.getURI()+'">',tinymce.each(d.contentCSS,function(e){t+='<link type="text/css" rel="stylesheet" href="'+d.documentBaseURI.toAbsolute(e)+'">'});var i=o.body_id||"tinymce";-1!=i.indexOf("=")&&(i=(i=d.getParam("body_id","","hash"))[d.id]||i);var n=o.body_class||"";-1!=n.indexOf("=")&&(n=(n=d.getParam("body_class","","hash"))[d.id]||"");var a=d.settings.directionality?' dir="'+d.settings.directionality+'"':"";if(e="<!DOCTYPE html><html><head>"+t+'</head><body id="'+i+'" class="mce-content-body '+n+'"'+a+">"+d.getContent()+"</body></html>",s)this.getEl("body").firstChild.src="data:text/html;charset=utf-8,"+encodeURIComponent(e);else{var r=this.getEl("body").firstChild.contentWindow.document;r.open(),r.write(e),r.close()}}})}),d.addButton("preview",{title:"Preview",cmd:"mcePreview"}),d.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})});