tinymce.PluginManager.add("pagebreak",function(c){var a="mce-pagebreak",o=c.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e"),t=new RegExp(o.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi"),n='<img src="'+tinymce.Env.transparentSrc+'" class="'+a+'" data-mce-resize="false" data-mce-placeholder />';c.addCommand("mcePageBreak",function(){c.settings.pagebreak_split_block?c.insertContent("<p>"+n+"</p>"):c.insertContent(n)}),c.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),c.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"}),c.on("ResolveName",function(e){"IMG"==e.target.nodeName&&c.dom.hasClass(e.target,a)&&(e.name="pagebreak")}),c.on("click",function(e){"IMG"===(e=e.target).nodeName&&c.dom.hasClass(e,a)&&c.selection.select(e)}),c.on("BeforeSetContent",function(e){e.content=e.content.replace(t,n)}),c.on("PreInit",function(){c.serializer.addNodeFilter("img",function(e){for(var a,t,n=e.length;n--;)if((t=(a=e[n]).attr("class"))&&-1!==t.indexOf("mce-pagebreak")){var r=a.parent;if(c.schema.getBlockElements()[r.name]&&c.settings.pagebreak_split_block){r.type=3,r.value=o,r.raw=!0,a.remove();continue}a.type=3,a.value=o,a.raw=!0}})})});