tinymce.ThemeManager.add("modern",function(s){function a(e,n){var i,r=[];if(e)return y(e.split(/[ ,]/),function(o){function e(){var e=s.selection;"bullist"==t&&e.selectorChanged("ul > li",function(e,t){for(var n,i=t.parents.length;i--&&("OL"!=(n=t.parents[i].nodeName)&&"UL"!=n););o.active(e&&"UL"==n)}),"numlist"==t&&e.selectorChanged("ol > li",function(e,t){for(var n,i=t.parents.length;i--&&("OL"!=(n=t.parents[i].nodeName)&&"UL"!=n););o.active(e&&"OL"==n)}),o.settings.stateSelector&&e.selectorChanged(o.settings.stateSelector,function(e){o.active(e)},!0),o.settings.disabledStateSelector&&e.selectorChanged(o.settings.disabledStateSelector,function(e){o.disabled(e)})}var t;"|"==o?i=null:b.has(o)?(o={type:o,size:n},r.push(o),i=null):(i||(i={type:"buttongroup",items:[]},r.push(i)),s.buttons[o]&&(t=o,"function"==typeof(o=s.buttons[t])&&(o=o()),o.type=o.type||"button",o.size=n,o=b.create(o),i.items.push(o),s.initialized?e():s.on("init",e)))}),{type:"toolbar",layout:"flow",items:r}}function c(t){function e(e){return e?(n.push(a(e,t)),!0):void 0}var n=[];if(tinymce.isArray(h.toolbar)){if(0===h.toolbar.length)return;tinymce.each(h.toolbar,function(e,t){h["toolbar"+(t+1)]=e}),delete h.toolbar}for(var i=1;i<10&&e(h["toolbar"+i]);i++);return n.length||!1===h.toolbar||e(h.toolbar||r),n.length?{type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:n}:void 0}function u(){function a(e){return"|"==e?{text:"|"}:s.menuItems[e]}function e(t){var e,n,i,o,r;if(r=tinymce.makeMap((h.removed_menuitems||"").split(/[ ,]/)),h.menu?(n=h.menu[t],o=!0):n=C[t],n){e={text:n.title},i=[],y((n.items||"").split(/[ ,]/),function(e){a(e)&&!r[e]&&i.push(a(e))}),o||y(s.menuItems,function(e){e.context==t&&("before"==e.separator&&i.push({text:"|"}),e.prependToContext?i.unshift(e):i.push(e),"after"==e.separator&&i.push({text:"|"}))});for(var l=0;l<i.length;l++)"|"!=i[l].text||0!==l&&l!=i.length-1||i.splice(l,1);if(e.menu=i,!e.menu.length)return null}return e}var t,n=[],i=[];if(h.menu)for(t in h.menu)i.push(t);else for(t in C)i.push(t);for(var o="string"==typeof h.menubar?h.menubar.split(/[ ,]/):i,r=0;r<o.length;r++){var l=o[r];(l=e(l))&&n.push(l)}return n}function d(n){function e(e){var t=n.find(e)[0];t&&t.focus(!0)}s.shortcuts.add("Alt+F9","",function(){e("menubar")}),s.shortcuts.add("Alt+F10","",function(){e("toolbar")}),s.shortcuts.add("Alt+F11","",function(){e("elementpath")}),n.on("cancel",function(){s.focus()})}function o(e,t){function n(e){return{width:e.clientWidth,height:e.clientHeight}}var i,o,r,l;i=s.getContainer(),o=s.getContentAreaContainer().firstChild,r=n(i),l=n(o),null!==e&&(e=Math.max(h.min_width||100,e),e=Math.min(h.max_width||65535,e),p.setStyle(i,"width",e+(r.width-l.width)),p.setStyle(o,"width",e)),t=Math.max(h.min_height||100,t),t=Math.min(h.max_height||65535,t),p.setStyle(o,"height",t),s.fire("ResizeEditor")}function m(){function r(){return s.contextToolbars||[]}function n(e){var t,n,i,o,r,l,a;if(!s.removed){if(!e||!e.toolbar.panel)return void y(s.contextToolbars,function(e){e.panel&&e.panel.hide()});a=["tc-bc","bc-tc","tl-bl","bl-tl","tr-br","br-tr"],(r=e.toolbar.panel).show(),i=function(e){var t,n,i;return t=tinymce.DOM.getPos(s.getContentAreaContainer()),n=s.dom.getRect(e),"BODY"==(i=s.dom.getRoot()).nodeName&&(n.x-=i.ownerDocument.documentElement.scrollLeft||i.scrollLeft,n.y-=i.ownerDocument.documentElement.scrollTop||i.scrollTop),n.x+=t.x,n.y+=t.y,n}(e.element),n=tinymce.DOM.getRect(r.getEl()),o=tinymce.DOM.getRect(s.getContentAreaContainer()||s.getBody()),s.inline||(o.w=s.getDoc().documentElement.offsetWidth),s.selection.controlSelection.isResizable(e.element)&&(i=g.inflate(i,0,7)),(t=g.findBestRelativePosition(n,i,o,a))?(y(a.concat("inside"),function(e){r.classes.toggle("tinymce-inline-"+e,e==t)}),l=g.relativePosition(n,i,t),r.moveTo(l.x,l.y)):(y(a,function(e){r.classes.toggle("tinymce-inline-"+e,!1)}),r.classes.toggle("tinymce-inline-inside",!0),(i=g.intersect(o,i))?(t=g.findBestRelativePosition(n,i,o,["tc-tc","tl-tl","tr-tr"]))?(l=g.relativePosition(n,i,t),r.moveTo(l.x,l.y)):r.moveTo(i.x,i.y):r.hide())}}function i(){function e(){s.selection&&n(o(s.selection.getNode()))}window.requestAnimationFrame?window.requestAnimationFrame(e):e()}function t(e){var t;return e.toolbar.panel?e.toolbar.panel.show():(l||(l=s.selection.getScrollContainer()||s.getWin(),tinymce.$(l).on("scroll",i),s.on("remove",function(){tinymce.$(l).off("scroll")})),t=b.create({type:"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!0,border:1,items:a(e.toolbar.items)}),(e.toolbar.panel=t).renderTo(document.body).reflow()),void n(e)}function o(e){var t,n,i,o=r();for(t=(i=s.$(e).parents().add(e)).length-1;0<=t;t--)for(n=o.length-1;0<=n;n--)if(o[n].predicate(i[t]))return{toolbar:o[n],element:i[t]};return null}var l;s.on("click keyup blur",function(){window.setTimeout(function(){var e;s.removed||((e=o(s.selection.getNode()))?t(e):tinymce.each(r(),function(e){e.panel&&e.panel.hide()}))},0)}),s.on("ObjectResizeStart",function(){var e=o(s.selection.getNode());e&&e.toolbar.panel&&e.toolbar.panel.hide()}),s.on("nodeChange ResizeEditor ResizeWindow",i),s.on("remove",function(){tinymce.each(r(),function(e){e.panel&&e.panel.remove()}),s.contextToolbars={}})}var f=this,h=s.settings,b=tinymce.ui.Factory,y=tinymce.each,p=tinymce.DOM,g=tinymce.ui.Rect,v=tinymce.ui.FloatPanel,C={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}},r="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";f.renderUI=function(e){var t=!1!==h.skin&&(h.skin||"lightgray");if(t){var n=h.skin_url;n=n?s.documentBaseURI.toAbsolute(n):tinymce.baseURL+"/skins/"+t,tinymce.Env.documentMode<=7?e.skinUiCss=n+"/skin.ie7.min.css":e.skinUiCss=n+"/skin.min.css",s.contentCSS.push(n+"/content"+(s.inline?".inline":"")+".min.css")}return s.on("ProgressState",function(e){f.throbber=f.throbber||new tinymce.ui.Throbber(f.panel.getEl("body")),e.state?f.throbber.show(e.time):f.throbber.hide()}),h.inline?function(e){function t(){if(l&&l.moveRel&&l.visible()&&!l._fixed){var e=s.selection.getScrollContainer(),t=s.getBody(),n=0,i=0;if(e){var o=p.getPos(t),r=p.getPos(e);n=Math.max(0,r.x-o.x),i=Math.max(0,r.y-o.y)}l.fixed(!1).moveRel(t,s.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(n,i)}}function n(){l&&(l.show(),t(),p.addClass(s.getBody(),"mce-edit-focus"))}function i(){l&&(l.hide(),v.hideAll(),p.removeClass(s.getBody(),"mce-edit-focus"))}function o(){return l?void(l.visible()||n()):(l=f.panel=b.create({type:r?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!!r,border:1,items:[!1===h.menubar?null:{type:"menubar",border:"0 0 1 0",items:u()},c(h.toolbar_items_size)]}),s.fire("BeforeRenderUI"),l.renderTo(r||document.body).reflow(),d(l),n(),m(),s.on("nodeChange",t),s.on("activate",n),s.on("deactivate",i),void s.nodeChanged())}var l,r;return h.fixed_toolbar_container&&(r=p.select(h.fixed_toolbar_container)[0]),h.content_editable=!0,s.on("focus",function(){e.skinUiCss?tinymce.DOM.styleSheetLoader.load(e.skinUiCss,o,o):o()}),s.on("blur hide",i),s.on("remove",function(){l&&(l.remove(),l=null)}),e.skinUiCss&&tinymce.DOM.styleSheetLoader.load(e.skinUiCss),{}}(e):function(e){var t,n,i;return e.skinUiCss&&tinymce.DOM.loadCSS(e.skinUiCss),t=f.panel=b.create({type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[!1===h.menubar?null:{type:"menubar",border:"0 0 1 0",items:u()},c(h.toolbar_items_size),{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}]}),!1!==h.resize&&(n={type:"resizehandle",direction:h.resize,onResizeStart:function(){var e=s.getContentAreaContainer().firstChild;i={width:e.clientWidth,height:e.clientHeight}},onResize:function(e){"both"==h.resize?o(i.width+e.deltaX,i.height+e.deltaY):o(null,i.height+e.deltaY)}}),!1!==h.statusbar&&t.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:!0,items:[{type:"elementpath"},n]}),h.readonly&&t.find("*").disabled(!0),s.fire("BeforeRenderUI"),t.renderBefore(e.targetNode).reflow(),h.width&&tinymce.DOM.setStyle(t.getEl(),"width",h.width),s.on("remove",function(){t.remove(),t=null}),d(t),m(),{iframeContainer:t.find("#iframe")[0].getEl(),editorContainer:t.getEl()}}(e)},f.resizeTo=o,f.resizeBy=function(e,t){var n=s.getContentAreaContainer();f.resizeTo(n.clientWidth+e,n.clientHeight+t)}});