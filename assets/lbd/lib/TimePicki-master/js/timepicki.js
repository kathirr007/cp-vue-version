!function(x){x.fn.timepicki=function(i){var t={format_output:function(i,t,e){return h.show_meridian?((i=Math.min(Math.max(parseInt(i),1),12))<10&&(i="0"+i),(t=Math.min(Math.max(parseInt(t),0),59))<10&&(t="0"+t),i+":"+t+" "+e):((i=Math.min(Math.max(parseInt(i),0),23))<10&&(i="0"+i),(t=Math.min(Math.max(parseInt(t),0),59))<10&&(t="0"+t),i+":"+(t=Math.min(Math.max(parseInt(t),0),59)))},increase_direction:"up",custom_classes:"",min_hour_value:1,max_hour_value:12,show_meridian:!0,step_size_hours:"1",step_size_minutes:"1",overflow_minutes:!1,disable_keyboard_mobile:!1,reset:!1,on_change:null,input_writable:!1},h=x.extend({},t,i);return this.each(function(){var s=x(this),t=s.outerHeight();t+=10,x(s).wrap("<div class='time_pick'>");var e=x(this).parents(".time_pick"),i="down"===h.increase_direction?"<div class='prev action-prev'></div>":"<div class='prev action-next'></div>",n="down"===h.increase_direction?"<div class='next action-next'></div>":"<div class='next action-prev'></div>",a=x("<div class='timepicker_wrap "+h.custom_classes+"'><div class='arrow_top'></div><div class='time'>"+i+"<div class='ti_tx'><input type='text' class='timepicki-input'"+(h.disable_keyboard_mobile?"readonly":"")+"></div>"+n+"</div><div class='mins'>"+i+"<div class='mi_tx'><input type='text' class='timepicki-input'"+(h.disable_keyboard_mobile?"readonly":"")+"></div>"+n+"</div>");h.show_meridian&&a.append("<div class='meridian'>"+i+"<div class='mer_tx'><input type='text' class='timepicki-input' readonly></div>"+n+"</div>"),h.reset&&a.append("<div><a href='#' class='reset_time'>Reset</a></div>"),e.append(a);var l=x(this).next(".timepicker_wrap"),r=(l.find("div"),e.find("input"));function m(i){return x.contains(e[0],i[0])||e.is(i)}function o(i,t){var e=l.find(".ti_tx input").val(),n=l.find(".mi_tx input").val(),a="";h.show_meridian&&(a=l.find(".mer_tx input").val()),0===e.length||0===n.length||h.show_meridian&&0===a.length||(s.attr("data-timepicki-tim",e),s.attr("data-timepicki-mini",n),h.show_meridian?(s.attr("data-timepicki-meri",a),s.val(h.format_output(e,n,a))):s.val(h.format_output(e,n))),null!==h.on_change&&h.on_change(s[0]),t&&d()}function u(){if(function(i){var t,e,n,a;s.is("[data-timepicki-tim]")?(e=Number(s.attr("data-timepicki-tim")),n=Number(s.attr("data-timepicki-mini")),h.show_meridian&&(a=s.attr("data-timepicki-meri"))):"object"==typeof i?(e=Number(i[0]),n=Number(i[1]),h.show_meridian&&(a=i[2])):(t=new Date,e=t.getHours(),n=t.getMinutes(),a="AM",h.show_meridian&&(0==e?e=12:12==e?a="PM":12<e&&(e-=12,a="PM")));e<10?l.find(".ti_tx input").val("0"+e):l.find(".ti_tx input").val(e);n<10?l.find(".mi_tx input").val("0"+n):l.find(".mi_tx input").val(n);h.show_meridian&&(a<10?l.find(".mer_tx input").val("0"+a):l.find(".mer_tx input").val(a))}(h.start_time),l.fadeIn(),!h.input_writable){var n=l.find("input:visible").first();n.focus()}var a=function(i){if(9===i.which&&i.shiftKey){n.off("keydown",a);var t=x(":input:visible:not(.timepicki-input)"),e=t.index(s);t.get(e-1).focus()}};n.on("keydown",a)}function d(){l.fadeOut()}function p(i,t){var e=Number(l.find(".time .ti_tx input").val()),n=Number(h.min_hour_value),a=Number(h.max_hour_value),s=Number(h.step_size_hours);if(i&&i.hasClass("action-next")||"next"===t)if(a<e+s){var r=n;r=r<10?"0"+r:String(r),l.find(".time .ti_tx input").val(r)}else(e+=s)<10&&(e="0"+e),l.find(".time .ti_tx input").val(e);else if(i&&i.hasClass("action-prev")||"prev"===t){if(e-s<Number(h.min_hour_value)){var m=a;m=m<10?"0"+m:String(m),l.find(".time .ti_tx input").val(m)}else(e-=s)<10&&(e="0"+e),l.find(".time .ti_tx input").val(e)}}function c(i,t){var e=Number(l.find(".mins .mi_tx input").val()),n=Number(h.step_size_minutes);i&&i.hasClass("action-next")||"next"===t?59<e+n?(l.find(".mins .mi_tx input").val("00"),h.overflow_minutes&&p(null,"next")):(e+=n)<10?l.find(".mins .mi_tx input").val("0"+e):l.find(".mins .mi_tx input").val(e):(i&&i.hasClass("action-prev")||"prev"===t)&&(e-n<=-1?(l.find(".mins .mi_tx input").val(60-n),h.overflow_minutes&&p(null,"prev")):(e-=n)<10?l.find(".mins .mi_tx input").val("0"+e):l.find(".mins .mi_tx input").val(e))}function v(i,t){var e,n="meridian";e=l.find("."+n+" .mer_tx input").val(),i&&i.hasClass("action-next")||"next"===t?"AM"==e?l.find("."+n+" .mer_tx input").val("PM"):l.find("."+n+" .mer_tx input").val("AM"):(i&&i.hasClass("action-prev")||"prev"===t)&&("AM"==e?l.find("."+n+" .mer_tx input").val("PM"):l.find("."+n+" .mer_tx input").val("AM"))}x(".reset_time").on("click",function(i){s.val(""),d()}),x(".timepicki-input").keydown(function(a){if(13==a.keyCode)return a.preventDefault(),o(),void d();var s=x(this).parent().parent(),r=x(this),m=r.val();done=!1,setTimeout(function(){done||(function(){var i=/^\d+$/.test(r.val()),t=""===r.val();if(s.hasClass("time"))if(i){var e=h.show_meridian?Math.min(Math.max(parseInt(r.val()),1),12):Math.min(Math.max(parseInt(r.val()),0),23);r.val(e)}else t||r.val(m);else if(s.hasClass("mins"))if(i){var n=Math.min(Math.max(parseInt(r.val()),0),59);r.val(n)}else t||r.val(m);else s.hasClass("meridian")&&a.preventDefault()}(),done=!0)},0)}),x(document).on("click",function(i){if(!x(i.target).is(l)&&"block"==l.css("display")&&!x(i.target).is(x(".reset_time")))if(x(i.target).is(s)){l.css({top:t+"px",left:"0px"}),u()}else o(i,!m(x(i.target)))}),s.on("focus",u),r.on("focus",function(){var i=x(this);i.is(s)||i.select()}),r.on("keydown",function(i){var t,e=x(this);38===i.which?t="down"===h.increase_direction?"prev":"next":40===i.which&&(t="down"===h.increase_direction?"next":"prev"),e.closest(".timepicker_wrap .time").length?p(null,t):e.closest(".timepicker_wrap .mins").length?c(null,t):e.closest(".timepicker_wrap .meridian").length&&h.show_meridian&&v(null,t)}),r.on("blur",function(){setTimeout(function(){var i=x(document.activeElement);i.is(":input")&&!m(i)&&(o(),d())},0)});var _=l.find(".action-next"),f=l.find(".action-prev");x(f).add(_).on("click",function(){var i=x(this);"time"==i.parent().attr("class")?p(i):"mins"==i.parent().attr("class")?c(i):h.show_meridian&&v(i)})})}}(jQuery);