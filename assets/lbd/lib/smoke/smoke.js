!function(d,c){var s={smoketimeout:[],init:!1,zindex:1e3,i:0,bodyload:function(e){var t=c.createElement("div");t.setAttribute("id","smoke-out-"+e),t.className="smoke-base",t.style.zIndex=s.zindex,s.zindex++,c.body.appendChild(t)},newdialog:function(){var e=(new Date).getTime();return e=Math.random(1,99)+e,s.init?s.bodyload(e):s.listen(d,"load",function(){s.bodyload(e)}),e},forceload:function(){},build:function(e,t){s.i++,t.stack=s.i,e=(e=e.replace(/\n/g,"<br />")).replace(/\r/g,"<br />");var n,i="",o="OK",a="Cancel",l="",c="";"prompt"===t.type&&(i='<div class="dialog-prompt"><input id="dialog-input-'+t.newid+'" type="text" '+(t.params.value?'value="'+t.params.value+'"':"")+" /></div>"),t.params.ok&&(o=t.params.ok),t.params.cancel&&(a=t.params.cancel),t.params.classname&&(l=t.params.classname),"signal"!==t.type&&(c='<div class="dialog-buttons">',"alert"===t.type?c+='<button id="alert-ok-'+t.newid+'">'+o+"</button>":"quiz"===t.type?(t.params.button_1&&(c+='<button class="quiz-button" id="'+t.type+"-ok1-"+t.newid+'">'+t.params.button_1+"</button>"),t.params.button_2&&(c+='<button class="quiz-button" id="'+t.type+"-ok2-"+t.newid+'">'+t.params.button_2+"</button>"),t.params.button_3&&(c+='<button class="quiz-button" id="'+t.type+"-ok3-"+t.newid+'">'+t.params.button_3+"</button>"),t.params.button_cancel&&(c+='<button id="'+t.type+"-cancel-"+t.newid+'" class="cancel">'+t.params.button_cancel+"</button>")):"prompt"!==t.type&&"confirm"!==t.type||(t.params.reverseButtons?c+='<button id="'+t.type+"-ok-"+t.newid+'">'+o+'</button><button id="'+t.type+"-cancel-"+t.newid+'" class="cancel">'+a+"</button>":c+='<button id="'+t.type+"-cancel-"+t.newid+'" class="cancel">'+a+'</button><button id="'+t.type+"-ok-"+t.newid+'">'+o+"</button>"),c+="</div>"),n='<div id="smoke-bg-'+t.newid+'" class="smokebg"></div><div class="dialog smoke '+l+'"><div class="dialog-inner">'+e+i+c+"</div></div>",s.init?s.finishbuild(e,t,n):s.listen(d,"load",function(){s.finishbuild(e,t,n)})},finishbuild:function(e,t,n){var i=c.getElementById("smoke-out-"+t.newid);for(i.className="smoke-base smoke-visible  smoke-"+t.type,i.innerHTML=n;""===i.innerHTML;)i.innerHTML=n;switch(s.smoketimeout[t.newid]&&clearTimeout(s.smoketimeout[t.newid]),s.listen(c.getElementById("smoke-bg-"+t.newid),"click",function(){s.destroy(t.type,t.newid),"prompt"===t.type||"confirm"===t.type||"quiz"===t.type?t.callback(!1):"alert"===t.type&&void 0!==t.callback&&t.callback()}),t.type){case"alert":s.finishbuildAlert(e,t,n);break;case"confirm":s.finishbuildConfirm(e,t,n);break;case"quiz":s.finishbuildQuiz(e,t,n);break;case"prompt":s.finishbuildPrompt(e,t,n);break;case"signal":s.finishbuildSignal(e,t,n);break;default:throw"Unknown type: "+t.type}},finishbuildAlert:function(e,t,n){s.listen(c.getElementById("alert-ok-"+t.newid),"click",function(){s.destroy(t.type,t.newid),void 0!==t.callback&&t.callback()}),c.onkeyup=function(e){e||(e=d.event),13!==e.keyCode&&32!==e.keyCode&&27!==e.keyCode||(s.destroy(t.type,t.newid),void 0!==t.callback&&t.callback())}},finishbuildConfirm:function(e,t,n){s.listen(c.getElementById("confirm-cancel-"+t.newid),"click",function(){s.destroy(t.type,t.newid),t.callback(!1)}),s.listen(c.getElementById("confirm-ok-"+t.newid),"click",function(){s.destroy(t.type,t.newid),t.callback(!0)}),c.onkeyup=function(e){e||(e=d.event),13===e.keyCode||32===e.keyCode?(s.destroy(t.type,t.newid),t.callback(!0)):27===e.keyCode&&(s.destroy(t.type,t.newid),t.callback(!1))}},finishbuildQuiz:function(e,t,n){var i,o,a;s.listen(c.getElementById("quiz-cancel-"+t.newid),"click",function(){s.destroy(t.type,t.newid),t.callback(!1)}),(i=c.getElementById("quiz-ok1-"+t.newid))&&s.listen(i,"click",function(){s.destroy(t.type,t.newid),t.callback(i.innerHTML)}),(o=c.getElementById("quiz-ok2-"+t.newid))&&s.listen(o,"click",function(){s.destroy(t.type,t.newid),t.callback(o.innerHTML)}),(a=c.getElementById("quiz-ok3-"+t.newid))&&s.listen(a,"click",function(){s.destroy(t.type,t.newid),t.callback(a.innerHTML)}),c.onkeyup=function(e){e||(e=d.event),27===e.keyCode&&(s.destroy(t.type,t.newid),t.callback(!1))}},finishbuildPrompt:function(e,t,n){var i=c.getElementById("dialog-input-"+t.newid);setTimeout(function(){i.focus(),i.select()},100),s.listen(c.getElementById("prompt-cancel-"+t.newid),"click",function(){s.destroy(t.type,t.newid),t.callback(!1)}),s.listen(c.getElementById("prompt-ok-"+t.newid),"click",function(){s.destroy(t.type,t.newid),t.callback(i.value)}),c.onkeyup=function(e){e||(e=d.event),13===e.keyCode?(s.destroy(t.type,t.newid),t.callback(i.value)):27===e.keyCode&&(s.destroy(t.type,t.newid),t.callback(!1))}},finishbuildSignal:function(e,t,n){c.onkeyup=function(e){e||(e=d.event),27===e.keyCode&&(s.destroy(t.type,t.newid),void 0!==t.callback&&t.callback())},s.smoketimeout[t.newid]=setTimeout(function(){s.destroy(t.type,t.newid),void 0!==t.callback&&t.callback()},t.timeout)},destroy:function(e,t){var n=c.getElementById("smoke-out-"+t);if("quiz"!==e)var i=c.getElementById(e+"-ok-"+t);var o=c.getElementById(e+"-cancel-"+t);if(n.className="smoke-base",i&&(s.stoplistening(i,"click",function(){}),c.onkeyup=null),"quiz"===e)for(var a=c.getElementsByClassName("quiz-button"),l=0;l<a.length;l++)s.stoplistening(a[l],"click",function(){}),c.onkeyup=null;o&&s.stoplistening(o,"click",function(){}),s.i=0,c.body.removeChild(n)},alert:function(e,t,n){"object"!=typeof n&&(n=!1);var i=s.newdialog();s.build(e,{type:"alert",callback:t,params:n,newid:i})},signal:function(e,t,n){"object"!=typeof n&&(n=!1);var i=5e3;"undefined"!==n.duration&&(i=n.duration);var o=s.newdialog();s.build(e,{type:"signal",callback:t,timeout:i,params:n,newid:o})},confirm:function(e,t,n){"object"!=typeof n&&(n=!1);var i=s.newdialog();s.build(e,{type:"confirm",callback:t,params:n,newid:i})},quiz:function(e,t,n){"object"!=typeof n&&(n=!1);var i=s.newdialog();s.build(e,{type:"quiz",callback:t,params:n,newid:i})},prompt:function(e,t,n){"object"!=typeof n&&(n=!1);var i=s.newdialog();return s.build(e,{type:"prompt",callback:t,params:n,newid:i})},listen:function(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):!!e.attachEvent&&e.attachEvent("on"+t,n)},stoplistening:function(e,t,n){return e.removeEventListener?e.removeEventListener(t,n,!1):!!e.detachEvent&&e.detachEvent("on"+t,n)},init:!0};"undefined"!=typeof module&&module.exports?module.exports=s:"function"==typeof define&&define.amd?define("smoke",[],function(){return s}):this.smoke=s}(window,document);